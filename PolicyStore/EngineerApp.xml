<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<PolicySet
 xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
 PolicySetId="root"
 Version="0.1.11"
 PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:deny-unless-permit">
 <Description>PolicySet for XACML model</Description>
 
 <Target />

 <Policy
  PolicyId="EngineeringAppAccessPolicy"
  Version="1.0"
  RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-unless-permit">
  
  <Description>Policy for controlling access to EngineeringApp by verifying attributes</Description>
  
  <!-- Target specifies this policy applies to the resource "EngineeringApp" -->
  <Target>
   <AnyOf>
    <AllOf>
     <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
      <AttributeValue
       DataType="http://www.w3.org/2001/XMLSchema#string">EngineeringApp</AttributeValue>
      <AttributeDesignator
       Category="urn:oasis:names:tc:xacml:3.0:resource-category:resource"
       AttributeId="urn:oasis:names:tc:xacml:1.0:resource:id"
       DataType="http://www.w3.org/2001/XMLSchema#string"
       MustBePresent="true" />
     </Match>
    </AllOf>
   </AnyOf>
  </Target>
  
  <!-- Rule specifies conditions for access -->
  <Rule RuleId="AttributeBasedAccessRule" Effect="Permit">
   <Description>Permit access to EngineeringApp if user role is Engineer and action is access</Description>
   
   <Target>
    <AnyOf>
     <AllOf>
      <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
       <AttributeValue
        DataType="http://www.w3.org/2001/XMLSchema#string">access</AttributeValue>
       <AttributeDesignator
        Category="urn:oasis:names:tc:xacml:3.0:action-category:action"
        AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
        DataType="http://www.w3.org/2001/XMLSchema#string"
        MustBePresent="true" />
      </Match>
     </AllOf>
    </AnyOf>
   </Target>
   
   <!-- Condition verifies the user role -->
   <Condition>
    <Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of">
     <Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal" />
      <AttributeValue
       DataType="http://www.w3.org/2001/XMLSchema#string">Engineer</AttributeValue>
      <AttributeDesignator
       AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-role"
       DataType="http://www.w3.org/2001/XMLSchema#string"
       MustBePresent="true"
       Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" />
    </Apply>
   </Condition>
  </Rule>
  
 </Policy>
</PolicySet>
